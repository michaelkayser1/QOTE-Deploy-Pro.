<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QOTE × AlphaEvolve × Resona Convergence</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', 'Courier New', monospace;
            background: #0a0a0f;
            color: #e0e0e0;
            overflow: hidden;
        }

        #container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        #header {
            padding: 20px;
            text-align: center;
            background: rgba(20, 20, 30, 0.8);
            border-bottom: 1px solid #333;
        }

        h1 {
            font-size: 24px;
            letter-spacing: 2px;
            color: #00d9ff;
            margin-bottom: 10px;
        }

        #subtitle {
            font-size: 12px;
            color: #888;
            letter-spacing: 1px;
        }

        #canvas-container {
            flex: 1;
            position: relative;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        #controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(20, 20, 30, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 11px;
            min-width: 250px;
        }

        .control-group {
            margin-bottom: 12px;
        }

        .control-label {
            color: #00d9ff;
            margin-bottom: 5px;
            display: block;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }

        .metric-value {
            color: #00ff88;
            font-weight: bold;
        }

        .status {
            padding: 5px 10px;
            border-radius: 4px;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }

        .status.safe {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 1px solid #00ff88;
        }

        .status.caution {
            background: rgba(255, 200, 0, 0.2);
            color: #ffc800;
            border: 1px solid #ffc800;
        }

        .status.danger {
            background: rgba(255, 60, 60, 0.2);
            color: #ff3c3c;
            border: 1px solid #ff3c3c;
        }

        #legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(20, 20, 30, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 11px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }

        .legend-color {
            width: 20px;
            height: 12px;
            margin-right: 10px;
            border-radius: 2px;
        }

        button {
            background: #00d9ff;
            color: #0a0a0f;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
        }

        button:hover {
            background: #00ffaa;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="header">
            <h1>QOTE × ALPHAEVOLVE × RESONA</h1>
            <div id="subtitle">When Mathematics Learned to Breathe</div>
        </div>
        <div id="canvas-container">
            <canvas id="canvas"></canvas>

            <div id="controls">
                <div class="control-group">
                    <div class="control-label">COHERENCE METRICS</div>
                    <div class="metric">
                        <span>Δθ_total:</span>
                        <span class="metric-value" id="delta-total">0.00</span>
                    </div>
                    <div class="metric">
                        <span>Current Δθ:</span>
                        <span class="metric-value" id="delta-current">0.00</span>
                    </div>
                    <div class="metric">
                        <span>Rhythm τ:</span>
                        <span class="metric-value" id="tau">1.00s</span>
                    </div>
                    <div class="metric">
                        <span>Phase ψ:</span>
                        <span class="metric-value" id="phase">0°</span>
                    </div>
                </div>

                <div id="status" class="status safe">SAFE ZONE</div>

                <button id="reset-btn">RESET SIMULATION</button>
            </div>

            <div id="legend">
                <div class="control-label">VISUAL ENCODING</div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00d9ff;"></div>
                    <span>Ψ₀ (Prove/Ground)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff00ff;"></div>
                    <span>Δθ (Evolve/Shift)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00ff88;"></div>
                    <span>τ (Refine/Rhythm)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ffc800;"></div>
                    <span>∞ (Generate/Recurse)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: rgba(255,255,255,0.1); border: 1px solid #333;"></div>
                    <span>Coherence Band</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Simulation state
        let time = 0;
        let deltaThetaTotal = 0;
        let currentDeltaTheta = 0;
        let phase = 0;
        const tau = 1.0;

        // Thresholds
        const DELTA_SAFE = Math.PI;
        const DELTA_MAX = 2 * Math.PI;

        // Particles representing AlphaEvolve states
        class Particle {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.vx = 0;
                this.vy = 0;
                this.type = type; // 'prove', 'evolve', 'refine', 'generate'
                this.phase = Math.random() * Math.PI * 2;
                this.radius = 4;
                this.trail = [];
                this.maxTrail = 50;
            }

            update(centerX, centerY, coherenceFactor) {
                // Oscillate based on type
                const freq = this.type === 'prove' ? 0.02 :
                            this.type === 'evolve' ? 0.04 :
                            this.type === 'refine' ? 0.03 : 0.05;

                this.phase += freq;

                // Spiral toward center (coherence)
                const dx = centerX - this.x;
                const dy = centerY - this.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                // Oscillation amplitude decreases as coherence increases
                const amplitude = 100 * (1 - coherenceFactor);

                // Combine spiraling with oscillation
                const targetX = centerX + Math.cos(this.phase) * amplitude;
                const targetY = centerY + Math.sin(this.phase) * amplitude;

                this.vx += (targetX - this.x) * 0.01;
                this.vy += (targetY - this.y) * 0.01;

                this.vx *= 0.95;
                this.vy *= 0.95;

                this.x += this.vx;
                this.y += this.vy;

                // Update trail
                this.trail.push({x: this.x, y: this.y});
                if (this.trail.length > this.maxTrail) {
                    this.trail.shift();
                }
            }

            draw() {
                // Draw trail
                if (this.trail.length > 1) {
                    ctx.strokeStyle = this.getColor();
                    ctx.lineWidth = 1;
                    ctx.globalAlpha = 0.3;
                    ctx.beginPath();
                    ctx.moveTo(this.trail[0].x, this.trail[0].y);
                    for (let i = 1; i < this.trail.length; i++) {
                        const alpha = i / this.trail.length;
                        ctx.globalAlpha = 0.3 * alpha;
                        ctx.lineTo(this.trail[i].x, this.trail[i].y);
                    }
                    ctx.stroke();
                }

                // Draw particle
                ctx.globalAlpha = 1;
                ctx.fillStyle = this.getColor();
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();

                // Glow effect
                const gradient = ctx.createRadialGradient(
                    this.x, this.y, 0,
                    this.x, this.y, this.radius * 3
                );
                gradient.addColorStop(0, this.getColor() + '66');
                gradient.addColorStop(1, this.getColor() + '00');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius * 3, 0, Math.PI * 2);
                ctx.fill();
            }

            getColor() {
                switch(this.type) {
                    case 'prove': return '#00d9ff';
                    case 'evolve': return '#ff00ff';
                    case 'refine': return '#00ff88';
                    case 'generate': return '#ffc800';
                    default: return '#ffffff';
                }
            }
        }

        // Create particles
        const particles = [];
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const types = ['prove', 'evolve', 'refine', 'generate'];

        function initParticles() {
            particles.length = 0;
            for (let i = 0; i < 20; i++) {
                const angle = (i / 20) * Math.PI * 2;
                const radius = 150;
                const x = canvas.width / 2 + Math.cos(angle) * radius;
                const y = canvas.height / 2 + Math.sin(angle) * radius;
                const type = types[i % 4];
                particles.push(new Particle(x, y, type));
            }
        }
        initParticles();

        // Draw coherence band
        function drawCoherenceBand(centerX, centerY) {
            // Safe zone
            ctx.strokeStyle = 'rgba(0, 255, 136, 0.3)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 80, 0, Math.PI * 2);
            ctx.stroke();

            // Caution zone
            ctx.strokeStyle = 'rgba(255, 200, 0, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 140, 0, Math.PI * 2);
            ctx.stroke();

            // Danger zone
            ctx.strokeStyle = 'rgba(255, 60, 60, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 200, 0, Math.PI * 2);
            ctx.stroke();
        }

        // Update metrics display
        function updateMetrics() {
            document.getElementById('delta-total').textContent = deltaThetaTotal.toFixed(2);
            document.getElementById('delta-current').textContent = currentDeltaTheta.toFixed(3);
            document.getElementById('tau').textContent = tau.toFixed(2) + 's';
            document.getElementById('phase').textContent = Math.floor((phase % (2 * Math.PI)) * 180 / Math.PI) + '°';

            // Update status
            const statusEl = document.getElementById('status');
            if (deltaThetaTotal < DELTA_SAFE) {
                statusEl.className = 'status safe';
                statusEl.textContent = 'SAFE ZONE';
            } else if (deltaThetaTotal < DELTA_MAX) {
                statusEl.className = 'status caution';
                statusEl.textContent = 'CAUTION ZONE';
            } else {
                statusEl.className = 'status danger';
                statusEl.textContent = 'DANGER ZONE';
            }
        }

        // Animation loop
        function animate() {
            // Clear canvas with trail effect
            ctx.fillStyle = 'rgba(10, 10, 15, 0.2)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            // Draw coherence band
            drawCoherenceBand(centerX, centerY);

            // Draw center point (Ψ₀)
            ctx.fillStyle = '#00d9ff';
            ctx.globalAlpha = 0.8;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 8, 0, Math.PI * 2);
            ctx.fill();

            // Pulsing center
            const pulse = Math.sin(time * 0.05) * 0.3 + 0.7;
            const gradient = ctx.createRadialGradient(
                centerX, centerY, 0,
                centerX, centerY, 30 * pulse
            );
            gradient.addColorStop(0, '#00d9ff88');
            gradient.addColorStop(1, '#00d9ff00');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 30 * pulse, 0, Math.PI * 2);
            ctx.fill();

            // Update phase and coherence
            time += 0.016; // ~60fps
            phase += 0.02;

            // Simulate Δθ accumulation
            currentDeltaTheta = Math.abs(Math.sin(time * 0.1)) * 0.05;
            deltaThetaTotal += currentDeltaTheta;

            // Calculate coherence factor (0 = chaotic, 1 = coherent)
            const coherenceFactor = Math.min(1, deltaThetaTotal / (DELTA_MAX * 1.5));

            // Update and draw particles
            particles.forEach(p => {
                p.update(centerX, centerY, coherenceFactor);
                p.draw();
            });

            // Draw connecting lines between nearby particles
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < 100) {
                        ctx.globalAlpha = (1 - dist / 100) * 0.3;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }

            // Update UI
            updateMetrics();

            // Reset if beyond danger zone for too long
            if (deltaThetaTotal > DELTA_MAX * 2) {
                setTimeout(() => {
                    deltaThetaTotal *= 0.5; // Consolidation
                }, 1000);
            }

            ctx.globalAlpha = 1;
            requestAnimationFrame(animate);
        }

        // Reset button
        document.getElementById('reset-btn').addEventListener('click', () => {
            time = 0;
            deltaThetaTotal = 0;
            currentDeltaTheta = 0;
            phase = 0;
            initParticles();
        });

        // Start animation
        animate();
    </script>
</body>
</html>
